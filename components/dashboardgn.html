<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #picture { display:none; width:50%; }
        #username { display:none; }
        /* สไตล์ปุ่มใหม่ */
        .btn-test {
            background-color: #ffc107;
            color: black;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Dash board general</h1>
    <img src="unnamed.jpg" id="picture" alt="whylogin">
    
    <form action="/test_post.html">
        <button type="submit" class="btn-test">⚙️ ไปหน้าทดสอบโพสต์ (Test Post)</button>
    </form>

    <a href="../Fronend_v1/create_post/post_work.html" class="btn-post-work">
    ไปที่หน้าโพสต์เวิร์ค
    </a>

    <form action="/job_form">
        <button style="display:none" type="submit" id='button_sd'>click</button>
    </form>
    
    <p id='username' name='username'></p>
    
    <form action="/change_data">
        <button style="display: none;" type="submit" id='button_change'>change data</button>
    </form>

    <form action="/logout">
        <button type="submit">logout</button>
    </form>
    
    <input type="hidden" id='role' name='role'>
    <div id='job_feed'>hello</div>

    <script>
        // โค้ด fetch ข้อมูลผู้ใช้และแสดง Feed งานของคุณยังคงเหมือนเดิม
        fetch('/api/user_info').then(response=>response.json()).then(data=>{
            if(data.loggedIn){
                if((data.role==='student'||data.role==='dev') && data.create_job !=1){
                    document.getElementById("button_sd").style.display='block';
                }
                if(data.create_job == 1){
                    document.getElementById("button_change").style.display='block';
                }
            }
        });

        function show_job(){
            fetch('/api/jobs').then(response=>response.json()).then(jobs=>{
                const feed = document.getElementById("job_feed");
                feed.innerHTML='';
                if(jobs.length===0){
                    feed.innerHTML="<p>No job right now :<</p>";
                    return;    
                }
                jobs.forEach(job=>{
                    const html = `
                        <div class='student_post' style="border:1px solid #ccc; margin:10px; padding:10px;">
                            <p>Name : ${job.username}</p>
                            <p>Job : ${job.job}</p>
                            <p>Group : ${job.user_group}</p>
                            <p>Contact number : ${job.user_number}</p>
                            <p>Budjet : ${job.budjet}</p>
                            <p>Description: ${job.des_cription}</p>
                        </div>
                    `;
                    feed.innerHTML += html;
                });
            });
        }
        show_job();
    </script>
</body>
</html>